<script>
function vdiTerminalClientManageController($scope, $rootElement, $element){
	var data = JSON.stringify({
	});

	$scope.rows = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].map(function(d, i){
		d = JSON.parse(data);
		d.name = Math.random().toString(36).substr(2);
		d.no = Math.round(Math.random() * 1000000);
		d.ip_mac = "192.168." + Math.ceil(Math.random() * 255) + "." + Math.ceil(Math.random() * 255);
		d.desktop_ip = "192.168." + Math.ceil(Math.random() * 255) + "." + Math.ceil(Math.random() * 255);
		d.schoolroom = (["物理", "化学", "中文", "哲学", "计算机"][Math.floor((Math.random() * 5))]) + "教室";
		d.status = ["正常", "异常"][Math.floor(Math.random() * 2)];
		d.accessDesktop = "个人桌面-" + String.fromCharCode(20000 + Math.floor(Math.random() * 200));
		d.accessDate = Date;
		d.accessDuration = Date.now() % 1000000;
		return d;
	});
	var _checkAll = $element.find("input[data-ng-model='rowCheckAll']")[0];
	var _cmdBtns = $element.find(".dt-toolbar .btn").addClass("disabled");
	var _cmdBatchBtns = _cmdBtns.filter(".isBatch");
	var _cmdSingleBtns = _cmdBtns.filter(".isSingle");
	var fn_some_check = function(_r){ return _r.checked; };
	var fn_change_buttons_state = function(){
		var _eles = $element.find("input[data-ng-model='row']");
		var _checkedLength = _eles.filter(":checked").length;
		if(_checkedLength){
			_cmdBtns.removeClass("disabled");
			if(_checkedLength > 1){
				_cmdSingleBtns.addClass("disabled");
			}
		}
		else{
			_cmdBtns.addClass("disabled");
		}
	};
	$scope.evCheckAll = function(checkAll){
		var _eles = $element.find("input[data-ng-model='row']");
		_eles.each(function(){
			this.checked = checkAll;
		});
		fn_change_buttons_state();
	};
	$scope.evCheck = function(check, id){
		_checkAll.checked = [].every.call($element.find("input[data-ng-model='row']"), function(_r){
			return _r.checked;
		});
		fn_change_buttons_state();
	};
}
</script>

<div class="well well-light">
	<section data-widget-grid="" id="teach-page">
		<!-- row -->
		<div class="row">

			<article class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
				<!-- Widget ID (each widget will need unique ID)-->
				<div
					class="jarviswidget"
					id="wid-desktop-teach"
					data-ng-controller="vdiTerminalClientManageController"
					data-widget-editbutton="true"
					data-widget-colorbutton="true"
					data-widget-editbutton="true"
					data-widget-togglebutton="true"
					data-widget-deletebutton="false"
					data-widget-fullscreenbutton="true"
					data-widget-custombutton="true"
					data-widget-collapsed="false"
					data-widget-sortable="true">
					<header>
						<span class="widget-icon"> <i class="fa fa-table"></i> </span>
						<h2>教学桌面</h2>
					</header>
					<!-- widget div-->
					<div>
						<!-- widget edit box -->
						<div class="jarviswidget-editbox">
							<!-- This area used as dropdown edit box -->
						</div>
						<!-- end widget edit box -->

						<!-- widget content -->
						<div class="widget-body no-padding">
							<div class="alert alert-info no-margin">
									<ul>
										<li>终端在启动时会自动向管理台登记。</li>
										<li>远程＂唤醒＂功能需要客户端本身的硬件支持＂Wake on LAN＂。</li>
										<li>＂序号＂为终端连接教学桌面时对应的虚拟机编号，如设置为负数或者超出虚拟机最大编号，则不能分到虚拟机。</li>
									</ul>
							</div>
							<div class="dataTables_wrapper form-inline no-footer">
								<div class="dt-toolbar">
									<div class="col-xs-12 col-sm-3"></div>
									<div class="col-sm-9 col-xs-10 hidden-xs">
										<a class="btn btn-info isBatch" href="javascript:">唤醒</a>
										<a class="btn btn-info isBatch" href="javascript:">关闭</a>
										<a class="btn btn-info isBatch" href="javascript:">中断会话</a>
										<a class="btn btn-info isSingle" href="javascript:">绑定虚拟机IP</a>
										<a class="btn btn-info isSingle" href="javascript:">终端配置</a>
										<a class="btn btn-info isSingle" href="javascript:">配置教室</a>
									</div>
								</div>
							</div>
							<div class="table-responsive">
								<table
									class="table table-bordered table-striped table-condensed table-hover smart-form has-tickbox"
									width="100%">
										<thead class="vdi_header">
											<tr>
												<th><label class="checkbox"><input type="checkbox" data-ng-model="rowCheckAll" data-ng-change="evCheckAll(rowCheckAll)" name="checkbox-inline"><i></i></label></th>
												<th>终端显示名</th>
												<th>登录序号</th>
												<th>终端IP/MAC</th>
												<th>固定桌面IP</th>
												<th>所属教室</th>
												<th>运行状态</th>
												<th>接入桌面</th>
												<th>接入时间</th>
												<th>接入时长</th>
											</tr>
										</thead>
										<tbody class="vdi_body">
											<tr data-ng-repeat="item in rows">
												<td><label class="checkbox"><input data-ng-model="row" data-ng-change="evCheck(row, item.id)" type="checkbox" value="{{item.id}}" name="checkbox-inline"><i></i></label></td>
												<td>{{ item.name }}</td>
												<td>{{ item.no }}</td>
												<td>{{ item.ip_mac }}</td>
												<td>{{ item.desktop_ip }}</td>
												<td>{{ item.schoolroom }}</td>
												<td>{{ item.status }}</td>
												<td>{{ item.accessDesktop }}</td>
												<td>{{ item.accessDate }}</td>
												<td>{{ item.accessDuration }}</td>
											</tr>
										</tbody>
								</table>
							</div>
						</div>
					</div>
				</div>
			</article>
		</div>
	</section>
</div>
<script>pageSetUp();</script>